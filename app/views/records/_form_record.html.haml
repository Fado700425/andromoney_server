= form_for @record do |f|
  -# the 1st line
  .form-group
    .container-fluid.record
      .row
        .col-md-3
          .input-group
            %span.input-group-addon
              = image_tag("currency_sign_dollar.png", width: "15px")
              #{t('amount')}
            = f.number_field(:mount, class: "form-control", step: 'any')
  .form-group
    .container-fluid.record
      .row
        .col-md-3
          .input-group
            %span.input-group-addon
              %span.glyphicon.glyphicon-calendar
              #{t('report.date')}
            = f.text_field(:date, {id: "datetimepicker_report", class: "form-control", })

  -# the 2nd line
  .form-group
    .container-fluid.record
      .row.row-full-width
        .col-md-10
          .col-md-3
            %span.label.label-primary.select-label
              %span.glyphicon.glyphicon-th-large
              #{t('category.main_category')}

            = f.select(:category, @expense_category.collect {|p| [ p.category , p.hash_key, :"data-image" => asset_path(p.photo_path) ]}, {selected: default_selected(@record.category,  @expense_category.first.hash_key)}, { class: "select-with-icon", id: "expense-category", size: 5 })

            = f.select(:category, @income_category.collect {|p| [ p.category , p.hash_key, :"data-image" => asset_path(p.photo_path) ]}, {selected: default_selected(@record.category,  @income_category.first.hash_key)}, { class: "select-with-icon", id: "income-category",  size: 5 })

            = f.select(:category, @transfer_category.collect {|p| [ p.category , p.hash_key, :"data-image" => asset_path(p.photo_path) ]}, {selected: default_selected(@record.category,  @transfer_category.first.hash_key)}, { class: "select-with-icon", id: "transfer-category", size: 5 })

          .col-md-3
            %span.label.label-primary.select-label
              %span.glyphicon.glyphicon-list-alt
              #{t('subcategory.subcategory')}

            = f.grouped_collection_select(:sub_category, @expense_category, :subcategories, :category, :hash_key, :subcategory, {selected: default_selected(@record.sub_category)}, {class: 'select-subcategory', id: "expense-subcategory", size: 6 })

            = f.grouped_collection_select(:sub_category, @income_category, :subcategories, :category, :hash_key, :subcategory, {selected: default_selected(@record.sub_category)}, {class: 'select-subcategory', id: "income-subcategory", size: 6 })

            = f.grouped_collection_select(:sub_category, @transfer_category, :subcategories, :category, :hash_key, :subcategory, {selected: default_selected(@record.sub_category)}, {class: 'select-subcategory', id: "transfer-subcategory", size: 6 })

          .col-md-3
            %span.label.label-primary.select-label
              %span.glyphicon.glyphicon-share
              #{t('payment.payment')}
            = f.select(:out_payment, @payments.collect {|p| [ p.payment_name + "-" + p.currency_code, p.hash_key, :"data-image" => asset_path(payment_icon(p.kind)) ]}, {selected: default_selected(@record.out_payment, @payments.first.hash_key)}, {class: 'select-with-icon', size: 5 })

          .col-md-3
            %span.label.label-primary.select-label
              %span.glyphicon.glyphicon-check
              #{t('payee.payee')}
            = f.select(:payee, @payees.collect {|p| [ p.payee_name, p.hash_key ]}, {selected: default_selected(@record.payee)}, {class: 'select-with-icon', id: "nontrans-receiver", size: 5 })

            = f.select(:in_payment, @payments.collect {|p| [ p.payment_name + "-" + p.currency_code, p.hash_key, :"data-image" => asset_path(payment_icon(p.kind)) ]}, {selected: default_selected(@record.in_payment, @payments.second.hash_key)}, {class: 'select-with-icon', id: "transfer-receiver", size: 5 })

        .col-md-2
          %span.label.label-primary.select-label
            %span.glyphicon.glyphicon-book
            #{t('project.project')}
          = f.select(:project, @projects.collect {|p| [ p.project_name, p.hash_key]}, {selected: default_selected(@record.project)}, {class: 'select-with-icon', size: 5 })

  -# the 3rd line: remark
  .form-group
    .input-group
      %span.input-group-addon
        %span.glyphicon.glyphicon-align-left
        #{t('note')}
      = f.text_area :remark, class: 'form-control'

  -# submit button
  .pull-right
    %br
    -#= f.submit t('confirm_add'), class: "btn btn-primary btn-lg"
    = f.button "儲存並新增下一筆", class: "btn btn-success btn-lg", name: "submit_type", value: "to_new"
    = f.button "儲存並回到列表", class: "btn btn-info btn-lg", name: "submit_type", value: "to_list"

:javascript
  var setSubcatFormat = function(id) {
    $(id).find("option").css({
      "padding":"5px 5px 5px 5px",
      "border-bottom":"1px solid #c3c3c3",
      "autocomplete":"off"
    });
  };
  setSubcatFormat("#expense-subcategory");
  setSubcatFormat("#income-subcategory");
  setSubcatFormat("#transfer-subcategory");